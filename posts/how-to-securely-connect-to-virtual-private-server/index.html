<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content><meta name=description content="For your information, this tutorial is not written by me absolutely, I&amp;rsquo;ve used ssh connection part of this tutorial and added some comments to make individual tutorial on &amp;ldquo;how to create your own vpn&amp;rdquo; and also covers the things that we can implement to make our vps the way more secure.
Generating SSH keys
Using a cleartext password to log in to your server is never a good idea since the password is not encrypted in transit and can be exposed on a hostile network."><meta name=keywords content="Yalchin Mammadli Software Developer Python Golang Node.js,VPS,Linux,Security"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=/posts/how-to-securely-connect-to-virtual-private-server/><title>How to Securely Connect to Virtual Private Server :: Yalchin's Blog — Notes about the things I learn</title><link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css rel=stylesheet type=text/css><link rel=stylesheet href=/main.4e5c639214707eff609bb55fe49e183dee42258a73bc90e4cc7b0a84f900798a.css><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color><link rel="shortcut icon" href=/favicon.ico><meta name=msapplication-TileColor content><meta itemprop=name content="How to Securely Connect to Virtual Private Server"><meta itemprop=description content="For your information, this tutorial is not written by me absolutely, I&rsquo;ve used ssh connection part of this tutorial and added some comments to make individual tutorial on &ldquo;how to create your own vpn&rdquo; and also covers the things that we can implement to make our vps the way more secure.
Generating SSH keys
Using a cleartext password to log in to your server is never a good idea since the password is not encrypted in transit and can be exposed on a hostile network."><meta itemprop=datePublished content="2022-04-24T14:26:43+04:00"><meta itemprop=dateModified content="2022-04-24T14:26:43+04:00"><meta itemprop=wordCount content="923"><meta itemprop=keywords content="VPS,Linux,Security,"><meta name=twitter:card content="summary"><meta name=twitter:title content="How to Securely Connect to Virtual Private Server"><meta name=twitter:description content="For your information, this tutorial is not written by me absolutely, I&rsquo;ve used ssh connection part of this tutorial and added some comments to make individual tutorial on &ldquo;how to create your own vpn&rdquo; and also covers the things that we can implement to make our vps the way more secure.
Generating SSH keys
Using a cleartext password to log in to your server is never a good idea since the password is not encrypted in transit and can be exposed on a hostile network."><meta property="article:published_time" content="2022-04-24 14:26:43 +0400 +0400"></head><body><div class=container><header class=header><span class=header__inner><a href=/ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>Hello, Friend</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=/posts>Blog</a></li><li><a href=/personal/contact>Contact</a></li><li><a href=/resume/cv.pdf>Resume</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>5 minutes</p></div><article><h1 class=post-title><a href=/posts/how-to-securely-connect-to-virtual-private-server/>How to Securely Connect to Virtual Private Server</a></h1><figure class=post-cover><img src=/blog-images/vps-hosting-page-banner.jpg alt="How to Securely Connect to Virtual Private Server"></figure><div class=post-content><p>For your information, this tutorial is not written by me absolutely, I&rsquo;ve used ssh connection part of <a href=https://notthebe.ee/Creating-your-own-OpenVPN-server.html>this</a> tutorial and added some comments to make individual tutorial on &ldquo;how to create your own vpn&rdquo; and also covers the things that we can implement to make our vps the way more secure.</p><p><strong>Generating SSH keys</strong></p><p>Using a cleartext password to log in to your server is never a good idea since the password is not encrypted in transit and can be exposed on a hostile network. By creating an SSH key we&rsquo;re going to make it so that you can only log in to the server if you have the key file and the password, and at the same time the password is encrypted. If you&rsquo;re using Linux you probably already know how to open the terminal, if you&rsquo;re on Mac you can find the Terminal app in your Applications folder, and on Windows 10 you&rsquo;ll need to open the PowerShell with administrator&rsquo;s privileges and install SSH using this command:</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>    PS C:<span style=color:#f99b15>\&gt;</span> Add-WindowsCapability -Online -Name OpenSSH.Client
</span></span></code></pre></div><p>This is the command that will generate our ssh keys. The RSA algorithm with 4096 key size is what I&rsquo;d personally recommend, since it&rsquo;s sufficiently secure and widely supported.</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>    ssh-keygen -t rsa -b <span style=color:#f99b15>4096</span>
</span></span></code></pre></div><p>Press Enter when asked for the key location to save it to the default one and then enter your password of choice.</p><p><strong>Logging in to the server</strong></p><p>By now our server has started up and we&rsquo;re ready to log in. Copy the IP address from the server control panel, go back to the terminal and type in</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>    ssh root@ip-address
</span></span></code></pre></div><p>Type <strong>yes</strong>, enter the root password that you specified in the first step and that&rsquo;s it, we&rsquo;re in.</p><p><strong>Updating the OS</strong></p><p>First and foremost, let&rsquo;s update our operating system and software:</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>    apt-get update <span style=color:#5bc4bf>&amp;&amp;</span> apt-get upgrade
</span></span></code></pre></div><p>I&rsquo;ll also install my favourite text editor, feel free to use whatever you want though, for example nano.</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>    apt install vim
</span></span></code></pre></div><p><strong>Creating a user</strong></p><p>As much as it&rsquo;s convenient to not have to enter a password every time, we need to create a user account that isn&rsquo;t root. Exposing root login on an SSH server is probably not a good idea even if you have multi factor authentication. Call me paranoid, but I think having to enter root password sometimes is the price I&rsquo;m willing to pay for some sense of security. Type</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>    useradd -G sudo -m wolfgang -s /bin/bash
</span></span></code></pre></div><p>That&rsquo;s going to create a user, set bash as default shell for him and permit sudo usage. Afterwards we&rsquo;ll need to create a password for our user, using</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>    passwd yourPassword
</span></span></code></pre></div><p>Enter your password twice and we&rsquo;re good to go.</p><p><strong>Copying SSH key from host to the server</strong></p><p>Now that we&rsquo;ve created our user it&rsquo;s a good time to copy the public SSH key to the server. Open a second terminal window for your local terminal and enter:</p><p><strong>Linux or Mac</strong></p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>    ssh-copy-id wolfgang@ip_address
</span></span></code></pre></div><p><strong>Windows</strong></p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>    type <span style=color:#ef6155>$env</span>:USERPROFILE<span style=color:#f99b15>\.</span>ssh<span style=color:#f99b15>\i</span>d_rsa.pub | ssh ip-address <span style=color:#48b685>&#34;cat &gt;&gt; .ssh/authorized_keys&#34;</span>
</span></span></code></pre></div><p>You&rsquo;ll be prompted to enter your password and once you do, go back to the terminal window with your server. Don&rsquo;t close the other window yet.</p><p><strong>Restricting SSH to key authentication</strong></p><p>Now that we&rsquo;ve copied the SSH keys to the server we have to restrict authentication to the public key only. Let&rsquo;s edit the sshd configuration file</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>    nvim /etc/ssh/sshd_config
</span></span></code></pre></div><p>First of all, let&rsquo;s change the default port. This won&rsquo;t do much for security, but it will help with those obnoxious SSH scanners that try to log in with default credentials. Not much, but the security logs will definitely get easier to read. You can use any port that&rsquo;s not taken by other services, but I prefer to use 69. Nice</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>    <span style=color:#776e71># Port 22 default</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    Port <span style=color:#f99b15>69</span> <span style=color:#776e71># make sure that the firewall is open for this port</span>
</span></span></code></pre></div><p>Next, we need to disable password authentication so that you&rsquo;re only able to log in using a public key.</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>    PasswordAuthentication no
</span></span></code></pre></div><p>Last but not least, let&rsquo;s also disable root login</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>    PermitRootLogin no
</span></span></code></pre></div><p><em>If you do so, make sure that the user that you are going to use to log in also has the public key in /home/your_user_name/.ssh/authorized_keys file</em></p><p>Now save the file and restart the sshd service using</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>    systemctl restart sshd
</span></span></code></pre></div><p>Now without closing this window let&rsquo;s go back to our local machine and try to log in with our key:</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>    ssh -i ~/.ssh/id_rsa wolfgang@ip_address -p <span style=color:#f99b15>69</span>
</span></span></code></pre></div><p>If you see the prompt to enter your key password, that means we&rsquo;re good to go. It&rsquo;s also a good idea to verify that we can&rsquo;t log in with our password anymore:</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>    ssh wolfgang@ip_address -p <span style=color:#f99b15>69</span>
</span></span></code></pre></div><p>This should give us “Permission denied”.</p><p><strong>Creating a server alias</strong></p><p>But you might have noticed that this command is kind of long and annoying to type, so let&rsquo;s fix that. Create a file in the “.ssh” folder in your home directory called “config” and edit it using your favourite text editor:</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>    nvim ~/.ssh/config
</span></span></code></pre></div><p>Here we&rsquo;re going to create an alias for our VPS</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>    Host wolfgangsvpn   <span style=color:#776e71># choose a name for your server</span>
</span></span><span style=display:flex><span>    User    wolgang    <span style=color:#776e71># the username of the user that we created</span>
</span></span><span style=display:flex><span>    Port <span style=color:#f99b15>69</span>
</span></span><span style=display:flex><span>    IdentityFile ~/.ssh/id_rsa   <span style=color:#776e71># that&#39;s the location of our key file</span>
</span></span><span style=display:flex><span>    HostName ip_address  <span style=color:#776e71># that&#39;s the IP address of our server</span>
</span></span></code></pre></div><p>Save and close, and now we can login to our server by simply typing:</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>    ssh wolfgangsvpn.
</span></span></code></pre></div><p>If you don&rsquo;t want to see this wall of text every time you login, type in:</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>    touch .hushlogin
</span></span></code></pre></div><p>If you do not want to deal with config file, you can use <a href=https://termius.com/linux>termius app</a> instead</p><p>Thanks for reading!</p></div></article><hr><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=/tags/vps/>VPS</a></span>
<span class=tag><a href=/tags/linux/>Linux</a></span>
<span class=tag><a href=/tags/security/>Security</a></span></p><div id=disqus_thread></div><script>(function(){var e=document,t=e.createElement("script");t.src="https://blog-yalchin-ml.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>923 Words</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>2022-04-24 10:26</p></div><div class=pagination><div class=pagination__buttons><span class="button previous"><a href=/posts/docker-compose-for-elastic-search-and-kibana/><span class=button__icon>←</span>
<span class=button__text>Docker Compose for Elastic Search and Kibana</span></a></span>
<span class="button next"><a href=/posts/how-to-set-up-github-ssh-key/><span class=button__text>How to Set Up GitHub Ssh Key</span>
<span class=button__icon>→</span></a></span></div></div><div id=comments><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//blog-yalchin-ml.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></main></div><footer class=footer></footer></div><script type=text/javascript src=/bundle.min.bb2c6bc3ed452ca4759660e4020811f248bc2320081559e8a32d8b0092773852941133639d35e8370d03d3ddaa750b1edd6b343c5bd22a55d5bdeae8f648f49b.js integrity="sha512-uyxrw+1FLKR1lmDkAggR8ki8IyAIFVnooy2LAJJ3OFKUETNjnTXoNw0D092qdQse3Ws0PFvSKlXVvero9kj0mw=="></script></body></html>